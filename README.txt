= jawptool =

'''jawptool'''とは、ウィキペディア日本語版のダンプデータを対象にデータ処理を行うプログラム。

ウィキペディア日本語版を編集していると、「ああ、このミスって機械的にチェックできそうだなぁ」と思うことがよくあったので、実際にチェックするツールを作ってみたというのがスタートです。チェックするには、ウィキペディアのデータを用意しなければなりませんが、そのためにクローラを作ってサイトにアクセスするなんてのは非道です。そして、実際そのような用途のためにデータベースダンプ http://dumps.wikimedia.org/jawiki/ が用意されていますので、そちらを使ってチェックするようにしました。そうして出来上がったのが、wpja-lint.plというプログラムです(非公開)。

チェックは出来たのですが、プログラムを作っているうちに「統計処理をしたら面白いかな」とか色々夢が膨らんできたので、チェック(lint)専用のツールではなく、汎用的なツールとして作り直したのが、このjawptoolです。(wpja→jawpのミスもここで修正しました)。

== 機能 ==
=== jawptool.pl ===
;lint-title
:記事名の文法チェックを行います。
:レポートの冒頭にも書いていますが、このチェックに引っかかったからといって、必ずしも間違った記事名というわけではありません。改名する場合は、その改名が適切か個別に判断してから行うようにお願いいたします。
:もちろん、プログラムのバグで誤って判定されている場合もあります。その場合は、バグレポートを出していただけると助かります。

;lint-text
:記事本文の文法チェックを行います。
:こちらもレポートの冒頭にも書いていますが、このチェックに引っかかったからといって、必ずしも間違っているとは限りません。修正を行う場合は、個別に判断してから行うようにお願いいたします。
:この機能は、[[プロジェクト:ウィキ文法のチェック]](現行は[http://toolserver.org/~sk/cgi-bin/checkwiki/checkwiki.cgi])に類似しています。プログラムを作り始めてからこのプロジェクトの存在を知りました。ということで二番煎じなのですが、jawptoolとしてはJPOVなチェックも積極的に取り入れていくことで、差別化が出来るのではないかと考えています。

;statistic
:記事データの統計情報をとります。
:MediaWiki本家統計ページとして[[特別:統計]]があります。しかし、ここに載ってない統計情報もjawptoolでは扱っています。逆に、本家統計でしか扱っていない情報もあります。
:被リンクの統計としては、[[特別:被リンクの多いページ]]がありますが、更新が止まっています。
:曖昧さ回避の統計としては[[利用者:Tatsujin28/曖昧さ回避ページの被リンク数]]があります。しかし、このページは更新が止まっています。手順はノートに書かれていますので、誰でも更新することは可能です。
:赤リンク統計としては、[[特別:存在しないページへのリンク]]があります。しかし、こちらも更新が止まっています。
:カテゴリ、ファイル、テンプレートの使用統計としては、[[特別:被リンクの多いカテゴリ]]、[[特別:被リンクの多いファイル]]、[[特別:使用箇所の多いテンプレート]]があります。jawptoolとは集計の基準が違うので、違った結果になっていますが、どちらも正しい(はず)です。

;titlelist
:タイトル一覧データをDumper形式で出力します。

;living-noref
:存命人物記事で出典のないものの一覧を出力します。
:[[Wikipedia‐ノート:即時削除の方針#存命中の人物で出典の無い記事を即時削除対象にする提案]]の議論をきっかけに、そもそも対象となる記事はどれくらいあるのだろうと思い作成しました。

文法チェック全てに言えることですが、チェック結果を元にした機械的な修正は厳に謹んで下さい。チェックに引っかかったとしても、必要があってわざとガイドラインを逸脱している可能性もあります。プログラムの開発時より後にガイドラインが更新されている可能性もあります。必ず実際の記事とガイドラインを確認の上で修正を行うようにしてください。

=== lint-text.cgi ===
;lint-text.cgi
:lint-textをCGI経由で実行するものです。文法チェックは記事単位で行います。


== 使用法 ==
=== jawptool.pl ===
プログラムのインストールの手順は特にありません。jawptool.plとJAWP.pmを作業用ディレクトリに置いてください。環境によっては、jawptoo.plの先頭行のperlのパスを修正する必要があるかもしれません。

解析するデータは http://dumps.wikimedia.org/jawiki/ よりダウンロードしてきます。基本的にpages-meta-current.xml.bz2か、pages-articles.xml.bz2のどちらかを使用します。jawptoolは標準入力からデータを受け取ることができませんので、bzip2は事前に解凍しておいてください。

usageは次の通りです。
<pre>
jawptool 0.20

Usage: jawptool.pl command xmlfile reportfile

command:
  lint-title
  lint-text
  lint-redirect
  lint-index
  statistic
  titlelist
  living-noref
  passed-sakujo
  person
  noindex
  index-list
  aimai
</pre>

=== lint-text.cgi ===
jawp-lint.cgiとJAWP.pmをウェブサーバからアクセスできるディレクトリに置いてください。ウェブブラウザからjawp-lint.cgiにアクセスすると、テキストフォームが表示されますので、そこにウィキテキストを入力し「lint」ボタンを押すとtext-lintの結果が表示されます。

== 歴史 ==
*2011年5月17日 - 初めてプログラムの構想を思いつく。
*2011年5月19日 - wpja-lintの開発開始。
*2011年5月27日 - wpjatoolに名称変更。
*2011年5月29日 - lint機能一通り完成。
*2011年6月3日 - jawptoolに名称変更。
*2011年7月13日 - 0.10公開。
*2011年7月24日 - 0.11公開。修正内容は以下の通り。
**lint-textのチェック項目強化
**lint-textの出力件数の上限を10000件に設定。
**titlelistの出力形式を修正
**テスト強化
**多少の高速化
**メモリ使用量の多少の削減
**その他バグ修正
*2011年7月27日 - 0.12公開。修正内容は以下の通り。
**ソースコード整理
**テスト強化
**その他バグ修正
*2011年8月9日 - 0.13公開。修正内容は以下の通り。
**LintText強化
***リンク先が曖昧さ回避またはリダイレクトの場合に警告
***存在しないカテゴリ、テンプレートの呼び出しを警告
**Statistic強化
***発リンクランキング
***節名の使用数ランキング
***外部リンクのドメイン統計
**メモリ使用量の多少の削減
**その他バグ修正
*2011年9月21日 - 0.20公開。修正内容は以下の通り。
**jawp-lint.cgi - 新設
**lint-redirect、lint-index、passed-sakujo、person、noindex、index-list、aimaiの各コマンドを新設
**living-noref - 出力上限1万件の制限を解除
**titlelist - Data::Dumperを使用しないように変更。名前空間ごとに別ファイルに出力するように変更
**statistic - 井戸端統計を追加
**その他バグ修正

より詳しい開発の経緯は http://www.saoyagi2.net/wikimedian/ に書かれています(それ以外のことも書いてますが)。コードの具体的な修正内容は http://sourceforge.jp/projects/jawptool/svn/view/ で閲覧できます。

== ライセンス ==
本プログラムはGPLv3でライセンスされます。ライセンスの詳細は同梱のGPL-3.0.txtを参照下さい。日本語参考訳は http://sourceforge.jp/projects/opensource/wiki/licenses%252FGNU_General_Public_License_version_3.0 などにあります。

== 付属ツール ==
;test.pl
:プログラムのテストを行います。全てパスするのが理想ですが、環境によってはパスしないかもしれません。その場合はバグレポートを送っていただけると幸いです。

;wiki2html.pl
:jawptoolの出力は基本的にwikiテキストになっています。これをhtmlに変換するツールです。ただし、現状はごく基本的なwiki記法にしか対応していません。

== TODO ==
*XMLパースが超いい加減なのをちゃんとする。ただし、速度低下は出来ればしないように。
*wiki2htmlの強化

== 既知のバグ ==
*Windows上のActivePerlでtest.plを実行すると、最後のCleanup()にて"Permission denied"で異常終了する。

== バグ報告 ==
プログラムにバグがありましたら、[http://sourceforge.jp/projects/jawptool/ プロジェクトトップページ]の「バグ報告」もしくは「フォーラム」までお知らせいただけたら助かります。

== 外部リンク ==
* [http://ja.wikipedia.org/wiki/Wikipedia:%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89 Wikipedia:データベースダウンロード]
* [http://dumps.wikimedia.org/jawiki/ ウィキペディア日本語版データベースダンプ]
* [http://sourceforge.jp/projects/jawptool/ ウィキペディア日本語版データ解析ツール] - プロジェクトトップページ
